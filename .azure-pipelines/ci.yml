trigger:
  batch: true
  branches:
    include:
      - master
      - develop
  paths:
    exclude:
      - .azure-pipelines/*
      - .vscode/*
      - docs/*
      - tools/*

pr:
  - develop

pool:
  vmImage: 'ubuntu-latest'

variables:
  IS_PULL_REQUEST: $[ eq(variables['Build.Reason'], 'PullRequest') ]
  IS_PROD_BUILD: $[ eq(variables['Build.SourceBranch'], 'refs/heads/master') ]

jobs:
  - job: initial_setup
    displayName: nx calculate commandas
    variables:
      IS_PR: $(IS_PULL_REQUEST)
    steps:
      - template: templates/steps_install-node-modules.yml
      - script: |
          echo "##vso[task.setvariable variable=COMMANDS;isOutput=true]$(node ./tools/scripts/nx-calculate-commands.js $(IS_PR))"
        name: setCommands
      - script: echo $(setCommands.COMMANDS)
        name: echoCommands
